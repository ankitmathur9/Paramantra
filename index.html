<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Paramantra Script Generator</title>

  <!-- MSAL -->
  <script src="https://alcdn.msauth.net/browser/2.38.0/js/msal-browser.min.js"></script>

  <style>
    body{margin:0;font-family:Segoe UI,Arial,sans-serif;background:#f3f6fb}
    .card{max-width:800px;margin:50px auto;padding:30px;background:#fff;
          border-radius:10px;box-shadow:0 4px 12px rgba(0,0,0,0.1)}
    h1{color:#0f56d3;margin:0 0 10px}
    .tag{color:#6b7280;margin-bottom:20px}
    .btn{background:#0f56d3;color:#fff;padding:10px 18px;border:0;
         border-radius:6px;cursor:pointer;font-weight:600}
    .btn.danger{background:#dc2626}
    .hidden{display:none}
    label{font-weight:600;margin-top:12px;display:block}
    input,textarea{width:100%;padding:8px;margin-top:4px;
                   border:1px solid #ccc;border-radius:6px}
    textarea{resize:vertical}
    .result{margin-top:20px;padding:15px;background:#f9fafb;border:1px solid #e5e7eb;
            border-radius:6px;white-space:pre-wrap}
  </style>
</head>
<body>
  <div class="card">
    <h1>Paramantra Script Generator</h1>
    <div class="tag">When probability meets structure, your data starts to think</div>

    <!-- Signed out view -->
    <div id="signedOut">
      <button id="loginBtn" class="btn">Sign in with Microsoft</button>
    </div>

    <!-- Signed in view -->
    <div id="signedIn" class="hidden">
      <div style="margin-bottom:15px">
        <strong id="userName"></strong><br>
        <span id="userEmail" style="font-size:14px;color:#555"></span><br>
        <button id="logoutBtn" class="btn danger" style="margin-top:10px">Sign Out</button>
      </div>

      <!-- Script form -->
      <div id="formPanel">
        <label>Prospect Name</label>
        <input id="prospectName" type="text">

        <label>Company</label>
        <input id="company" type="text">

        <label>Title / Role</label>
        <input id="title" type="text">

        <label>Industry</label>
        <input id="industry" type="text">

        <label>Pain Points (comma separated)</label>
        <textarea id="painPoints"></textarea>

        <button id="generateBtn" class="btn" style="margin-top:15px">Generate Script</button>
      </div>

      <!-- Script output -->
      <div id="resultArea" class="result hidden"></div>
    </div>
  </div>

  <script>
    // MSAL config
    const msalConfig = {
      auth: {
        clientId: "e9739aed-38bc-4937-a166-df136fa59c5c",
        authority: "https://login.microsoftonline.com/847b3797-657d-4cf9-8583-5ca191fabede",
        redirectUri: "https://ankitmathur9.github.io/Paramantra/"
      }
    };
    const loginRequest = { scopes: ["User.Read"] };
    const msalInstance = new msal.PublicClientApplication(msalConfig);

    document.addEventListener('DOMContentLoaded', () => {
      const loginBtn = document.getElementById('loginBtn');
      const logoutBtn = document.getElementById('logoutBtn');
      const signedOut = document.getElementById('signedOut');
      const signedIn = document.getElementById('signedIn');
      const userName = document.getElementById('userName');
      const userEmail = document.getElementById('userEmail');
      const generateBtn = document.getElementById('generateBtn');
      const resultArea = document.getElementById('resultArea');

      // Handle redirect
      msalInstance.handleRedirectPromise().then((response) => {
        if (response && response.account) {
          msalInstance.setActiveAccount(response.account);
        }
        const account = msalInstance.getActiveAccount();
        if (account) {
          showSignedIn(account);
        }
      });

      // Sign in
      loginBtn.addEventListener('click', () => {
        console.log("Login button clicked");
        msalInstance.loginRedirect(loginRequest);
      });

      // Sign out
      logoutBtn.addEventListener('click', () => {
        const account = msalInstance.getActiveAccount();
        if (account) {
          msalInstance.logoutRedirect({ account });
        }
      });

      // Show signed in
      function showSignedIn(account) {
        signedOut.classList.add('hidden');
        signedIn.classList.remove('hidden');
        userName.textContent = account.name || "";
        userEmail.textContent = account.username || "";
      }

      // Script generation
      generateBtn.addEventListener('click', () => {
        const prospect = document.getElementById('prospectName').value.trim() || "your prospect";
        const company = document.getElementById('company').value.trim() || "the company";
        const title = document.getElementById('title').value.trim() || "the team";
        const industry = document.getElementById('industry').value.trim() || "your industry";
        const pains = document.getElementById('painPoints').value.trim() || "common challenges";

        const script = `Opening:
Hello ${prospect}, this is ${msalInstance.getActiveAccount()?.name || "a consultant"} from Paramantra.

Qualify:
I often hear ${pains} are slowing down ${title} at ${company}. Is that your experience?

Value:
Paramantra is designed for ${industry} teams to cut manual work and boost adoption. Our clients see measurable gains within weeks.

Close:
Would it make sense to schedule a 20-minute Factory Visit demo next week?`;

        resultArea.textContent = script;
        resultArea.classList.remove('hidden');
      });
    });
  </script>
</body>
</html>
